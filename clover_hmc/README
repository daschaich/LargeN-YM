# ------------------------------------------------------------------
Wilson-clover HMC

Features:
  nHYP-smeared Wilson-clover fermions
  HMC with three time scales (two fermion scales and gauge)
  Omelyan integrator
  Optional Hasenbusch preconditioning with one shift
  SU(N) with N = 2, 3 and 4
  Several representations: fundamental, two-index (anti-)symmetric (depending on N)
  Optional fermion-rep (smeared) plaquette term in the gauge action

References:
  Omelyan tuning: hep-lat/0505020
  Hasenbusch preconditioning with multiple time scales: hep-lat/0506011

This HMC essentially merges parts of two different versions of the MILC code
To simplify things I stripped out some features that I don't expect to use, such as Schroedinger functional boundary conditions

defines.h defines Omelyan parameters, nHYP IR_STAB and EPS_SQ, as well as CG_DEBUG and NHYP_DEBUG

Compiling the libraries with -DFAST only works if NCOL = DIMF = 3
In serial this seems to speed up the 3F HMC by ~5%, but no clear effect is visible on two cores

Debugging checks:
  The usual check that Delta S scales quadratically with step size
    Passes for 2F, 3F, 4F and 3A
    Fails for 3S (even without smearing) and 4A
  None of the following have yet been done:
  Reversibility
  Comparison with leapfrog integrator
  Set Hasenbusch_mass=mass and generate random numbers only for the
    first pseudofermion (copying them into the second)
    At the least, PF=1 and PF=2 should then produce identical results
  Compare single-pseudofermion code with single-level Omelyan (if I wrote one)
# ------------------------------------------------------------------



# ------------------------------------------------------------------
# Sample input file not including Hasenbusch preconditioning:
# Both inner and outer loops work on the same fermion fields
# Still need to specify nstep for both loops
# Roughly, dt = traj_length / N where N = 2 * nstep[0] * nstep[1]
#          (update_step does two inner loops for each outer step)
# nstep_gauge is number of (cheap) gauge steps per inner fermion step
prompt 0
nflavors 2
nx 4
ny 4
nz 4
nt 4
iseed 41

warms 0
trajecs 3
traj_length 1
number_of_PF 1
nstep 5
nstep 2
nstep_gauge 5
traj_between_meas 3

beta 5.0
beta_frep 0.0
kappa 0.125
shift 0.2
clov_c 1.0
u0 1.0

alpha_hyp0 0
alpha_hyp1 0
alpha_hyp2 0

max_cg_iterations 500
max_cg_restarts 1
error_per_site 1e-6
error_for_propagator 1e-6

reload_serial config.3F.4444
forget
# ------------------------------------------------------------------



# ------------------------------------------------------------------
# Sample input file with Hasenbusch preconditioning:
prompt 0
nflavors 2
nx 4
ny 4
nz 4
nt 4
iseed 41

warms 0
trajecs 3
traj_length 1
number_of_PF 2
nstep 5                   # Number of steps for light-fermion outer level
nstep 2                   # Number of inner Hasenbusch steps per outer step
nstep_gauge 5
traj_between_meas 1

beta 5.0
beta_frep 0.0
kappa 0.125
shift 0.2
clov_c 1.0
u0 1.0

alpha_hyp0 0
alpha_hyp1 0
alpha_hyp2 0

max_cg_iterations 500
max_cg_restarts 1
error_per_site 1e-6
error_for_propagator 1e-6

reload_serial config.3F.4444
forget
# ------------------------------------------------------------------
